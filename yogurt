#!/usr/bin/env ruby

# Creator: Jose Augusto
# Create date: 20/08/2018
# Contribuitors: Esdras Tarsis, brazilian ruby community.

# gems
require 'open-uri'
require 'json'
require 'rubygems/package'
require 'zlib'

# Local Modules
require_relative 'modules/help'
require_relative 'modules/install'
require_relative 'modules/search'
require_relative 'modules/update'

class Main
  # include function from modules
  include Help
  include Install
  include Search
  include Update

  def initialize
    raise 'Requires ruby >= 2.4.0' if RUBY_VERSION <= '2.4.0'

    str = ARGV[0].to_s

    if ARGV.empty?
      update
    elsif str[0] != '-'
      search
    end

    case ARGV[0]
    when '-S'
      install_pkg

    when '-U'
      update

    when '-h', '--help'
      help

    when '-v', '--version'
      puts 'yogurt aur helper version: 3.0'

    else
      option = ARGV[0].to_s
      if option[0] == '-'
        puts "Invalid option #{option}"
        puts "Try 'yogurt --help' for more information."
        exit
      end
    end
  end
end

Main.new
